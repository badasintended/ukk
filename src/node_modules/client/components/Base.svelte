<script lang="ts">
    import { goto } from "@sapper/app";
    import Cookies from "js-cookie";
    import SvgDashboard from "client/svg/Dashboard.svelte";
    import SvgLines from "client/svg/Lines.svelte";
    import SvgLogout from "client/svg/Logout.svelte";
    import SvgMenu from "client/svg/Menu.svelte";
    import SvgTransaction from "client/svg/Transaction.svelte";
    import SvgUser from "client/svg/User.svelte";

    let collapsed = Cookies.get("sidebarCollapsed") !== undefined;

    function collapse() {
        collapsed = !collapsed;

        // save to cookie so the state is saved and accessible between page
        // since we only need a boolean, just remove it and check if it's present lmao
        collapsed ? Cookies.set("sidebarCollapsed", "") : Cookies.remove("sidebarCollapsed");
    }

    export let pageName: string;
</script>

<svelte:head>
    <title>{pageName}</title>
</svelte:head>

<!-- content -->
<div class="transition-spacing transition-opacity ease-in-out duration-700 pl-{collapsed ? 20 : 52} mr-4 my-4">
    <div class="text-3xl font-bold mb-2">{pageName}</div>
    <slot />
</div>

<!-- sidebar -->
<div
    class="transition ease-out duration-700 transform fixed left-0 flex flex-col w-48 bg-gray-900 h-full text-gray-200"
    class:-translate-x-32={collapsed}>
    <button
        class="w-full flex px-5 py-3 space-x-4 focus:outline-none hover:bg-gray-600"
        type="button"
        on:click={collapse}>
        <div class="transition ease-out duration-700 transform" class:translate-x-32={collapsed}><SvgLines /></div>
        <div class="transition ease-in-out duration-1000" class:opacity-0={collapsed}>Collapse</div>
    </button>
    <div class="flex-grow" />
    <button
        class="w-full flex px-5 py-3 space-x-4 focus:outline-none hover:bg-gray-600"
        type="button"
        on:click={() => goto("/dashboard")}>
        <div class="transition ease-out duration-700 transform" class:translate-x-32={collapsed}><SvgDashboard /></div>
        <div class="transition ease-in-out duration-1000" class:opacity-0={collapsed}>Dashboard</div>
    </button>
    <button
        class="w-full flex px-5 py-3 space-x-4 focus:outline-none hover:bg-gray-600"
        type="button"
        on:click={() => goto("/menu")}>
        <div class="transition ease-out duration-700 transform" class:translate-x-32={collapsed}><SvgMenu /></div>
        <div class="transition ease-in-out duration-1000" class:opacity-0={collapsed}>Menu</div>
    </button>
    <button
        class="w-full flex px-5 py-3 space-x-4 focus:outline-none hover:bg-gray-600"
        type="button"
        on:click={() => goto("/customer")}>
        <div class="transition ease-out duration-700 transform" class:translate-x-32={collapsed}><SvgUser /></div>
        <div class="transition ease-in-out duration-1000" class:opacity-0={collapsed}>Customer</div>
    </button>
    <button
        class="w-full flex px-5 py-3 space-x-4 focus:outline-none hover:bg-gray-600"
        type="button"
        on:click={() => goto("/transaction")}>
        <div class="transition ease-out duration-700 transform" class:translate-x-32={collapsed}>
            <SvgTransaction />
        </div>
        <div class="transition ease-in-out duration-1000" class:opacity-0={collapsed}>Transaction</div>
    </button>
    <div class="flex-grow" />
    <button
        class="w-full flex px-5 py-3 space-x-4 focus:outline-none text-red-500 hover:bg-red-600 hover:text-white"
        type="button"
        on:click={collapse}>
        <div class="transition-transform ease-out duration-700 transform" class:translate-x-32={collapsed}>
            <SvgLogout />
        </div>
        <div class="transition-opacity ease-in-out duration-1000" class:opacity-0={collapsed}>Logout</div>
    </button>
</div>